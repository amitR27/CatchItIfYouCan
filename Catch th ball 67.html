<!DOCTYPE html>
<html lang="en">
<head>
<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-495620179"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-495620179');
</script>
<!-- End Google Analytics -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Catch the Ball Game - High Score Added</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      background: linear-gradient(to bottom, #74ebd5, #acb6e5);
      display: flex; justify-content: center; align-items: flex-start;
      height: 100vh; overflow: hidden;
    }
    .game-container {
      position: relative; width: 100vw; max-width: 600px; height: 90vh;
      background: #fff; overflow: hidden; border: 3px solid #333;
      transition: background 0.5s ease;
    }
    .ball {
      width: 20px; height: 20px; background: red; border-radius: 50%;
      position: absolute; top: 10px; left: 50%; transform: translateX(-50%);
    }
    .paddle {
      width: 150px; height: 25px; background: black;
      position: absolute; bottom: 30px; border-radius: 10px;
      touch-action: none;
    }
    .score {
      font-size: 18px; position: absolute; top: 10px; left: 10px;
      font-family: Arial, sans-serif; color: #333;
    }
    .game-over {
      font-size: 30px; color: red;
      position: absolute; top: 50%; left: 50%;
      transform: translate(-50%, -50%); display: none; text-align: center;
    }
    #restartBtn {
      position: absolute; top: 60%; left: 50%; transform: translateX(-50%);
      padding: 10px 20px; display: none; cursor: pointer;
      background: #4CAF50; border: none; color: #fff; border-radius: 5px;
      z-index: 30;
    }
    .ball-bounce { animation: bounceEffect 0.2s ease-out; }
    @keyframes bounceEffect { 0% { transform: scale(1); } 50% { transform: scale(1.2); } 100% { transform: scale(1); } }
    .star {
      position: absolute; width: 6px; height: 6px;
      background: red; border-radius: 50%; opacity: 1;
      pointer-events: none; animation: starOut 0.8s ease-out forwards;
    }
    @keyframes starOut { 0% { transform: translate(0,0) scale(1); opacity:1; } 100% { transform: translate(var(--sx), var(--sy)) scale(0.5); opacity:0; } }
    .paused-overlay {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.5); display: none;
      justify-content: center; align-items: center;
      color: #fff; font-size: 48px; font-family: Arial, sans-serif;
      z-index: 20;
    }
    #pauseBtn {
      position:absolute; top:10px; right:10px;
      padding:10px 16px; font-size:16px; font-family:Arial,sans-serif;
      border:none; border-radius:6px; background:#007bff;
      color:#fff; cursor:pointer; box-shadow:0 4px 8px rgba(0,0,0,0.15);
      transition:background 0.2s, transform 0.1s;
      z-index: 50;
    }
    #pauseBtn:hover { background:#0056b3; transform:translateY(-2px); }
    #pauseBtn:active { transform:translateY(0); box-shadow:0 2px 4px rgba(0,0,0,0.2); }
  </style>
</head>
<body>
  <div class="game-container" id="game">
    <div class="score" id="score">Score: 0 | Lives: 3 | High Score: 0</div>
    <button id="pauseBtn">⏸ Pause</button>
    <div class="paused-overlay" id="pausedOverlay">PAUSED</div>
    <div class="ball" id="ball"></div>
    <div class="paddle" id="paddle"></div>
    <div class="game-over" id="gameOver">Game Over!<br>Final Score: <span id="finalScore">0</span></div>
    <button id="restartBtn">Play Again</button>
  </div>

  <audio id="bounceSound" src="https://www.soundjay.com/button/beep-07.wav" preload="auto"></audio>
  <audio id="gameOverSound" src="https://www.soundjay.com/button/beep-10.wav" preload="auto"></audio>

  <script>
    const gc = document.getElementById('game');
    const ball = document.getElementById('ball');
    const paddle = document.getElementById('paddle');
    const scoreEl = document.getElementById('score');
    const gameOverEl = document.getElementById('gameOver');
    const restartBtn = document.getElementById('restartBtn');
    const finalScoreEl = document.getElementById('finalScore');
    const bounceSound = document.getElementById('bounceSound');
    const gameOverSound = document.getElementById('gameOverSound');
    const pauseBtn = document.getElementById('pauseBtn');
    const pausedOverlay = document.getElementById('pausedOverlay');

    let x, y, baseSpeed, dirX, dirY, paddleX;
    let score, lives, running, paused;
    let lastTime = 0, highScore = parseInt(localStorage.getItem('catchBallHighScore')) || 0;
    const colors = ['#fdebd3','#d6eaf8','#d5f5e3','#f9e79f','#fadbd8','#e8daef'];

    function init() {
      x = gc.clientWidth/2 - ball.offsetWidth/2;
      y = 20;
      baseSpeed = 3; dirX = 1; dirY = 1;
      paddleX = (gc.clientWidth - paddle.offsetWidth)/2;
      score = 0; lives = 3; running = true; paused = false;
      pauseBtn.textContent = '⏸ Pause'; pausedOverlay.style.display = 'none';
      gc.style.background = colors[0];
      updateScore(); gameOverEl.style.display = 'none'; restartBtn.style.display = 'none';
      ball.style.left = x + 'px'; ball.style.top = y + 'px'; paddle.style.left = paddleX + 'px';
      requestAnimationFrame(gameLoop);
    }

    function updateScore() {
      if (score > highScore) {
        highScore = score;
        localStorage.setItem('catchBallHighScore', highScore);
      }
      scoreEl.textContent = `Score: ${score} | Lives: ${lives} | High Score: ${highScore}`;

      if (score > 0 && score % 10 === 0) {
        const idx = ((score / 10) - 1) % colors.length;
        gc.style.background = colors[(idx + 1) % colors.length];
      }

      if (score > 0 && score % 5 === 0) {
        baseSpeed += 0.5;
      }
    }

    function createParticles(cx, cy, count=15) {
      const frag = document.createDocumentFragment();
      for (let i = 0; i < count; i++) {
        const p = document.createElement('div'); p.className = 'star';
        p.style.left = cx + 'px'; p.style.top = cy + 'px';
        const angle = Math.random()*2*Math.PI, dist = Math.random()*40+20;
        p.style.setProperty('--sx', Math.cos(angle)*dist + 'px');
        p.style.setProperty('--sy', Math.sin(angle)*dist + 'px');
        frag.append(p); setTimeout(() => p.remove(), 800);
      }
      gc.append(frag);
    }

    function gameLoop(time) {
      if (!running) return;
      if (paused) { requestAnimationFrame(gameLoop); return; }
      const dt = (time - lastTime) / 1000; lastTime = time;
      const speed = baseSpeed;

      x += dirX * speed * dt * 60;
      y += dirY * speed * dt * 60;
      const maxX = gc.clientWidth - ball.offsetWidth;

      if (x <= 0) { x = 0; dirX = 1; bounce(); }
      if (x >= maxX) { x = maxX; dirX = -1; bounce(); }
      if (y <= 0) { y = 0; dirY = 1; bounce(); }

      const maxY = gc.clientHeight - ball.offsetHeight;
      if (y >= maxY) { lives--; updateScore(); if (lives > 0) resetBall(); else return endGame(); }

      const padTop = gc.clientHeight - paddle.offsetHeight - 30;
      if (dirY > 0 && y + ball.offsetHeight >= padTop && x + ball.offsetWidth > paddleX && x < paddleX + paddle.offsetWidth) {
        y = padTop - ball.offsetHeight;
        dirY = -1;
        bounce();
        score++;
        updateScore();
      }

      ball.style.left = x + 'px';
      ball.style.top = y + 'px';
      requestAnimationFrame(gameLoop);
    }

    function bounce() {
      ball.classList.add('ball-bounce');
      void ball.offsetWidth;
      ball.classList.remove('ball-bounce');
      bounceSound.currentTime = 0;
      bounceSound.play().catch(() => {});
      ball.style.background = `hsl(${Math.random()*360},70%,50%)`;
      createParticles(x + ball.offsetWidth / 2, y + ball.offsetHeight / 2);
    }

    function resetBall() {
      x = gc.clientWidth / 2 - ball.offsetWidth / 2;
      y = 20;
      dirY = 1;
    }

    function endGame() {
      running = false;
      gameOverSound.currentTime = 0;
      gameOverSound.play().catch(() => {});
      setTimeout(() => {
        gameOverEl.style.display = 'block';
        restartBtn.style.display = 'block';
        finalScoreEl.textContent = score;
      }, 1000);
    }

    gc.addEventListener('touchmove', e => {
      e.preventDefault();
      const bx = e.touches[0].clientX - gc.getBoundingClientRect().left - paddle.offsetWidth / 2;
      paddleX = Math.max(0, Math.min(bx, gc.clientWidth - paddle.offsetWidth));
      paddle.style.left = paddleX + 'px';
    });

    pauseBtn.addEventListener('click', () => {
      paused = !paused;
      pausedOverlay.style.display = paused ? 'flex' : 'none';
      pauseBtn.textContent = paused ? '▶ Resume' : '⏸ Pause';
      if (!paused) requestAnimationFrame(gameLoop);
    });

    restartBtn.addEventListener('click', () => {
      init();
    });

    init();
  </script>
</body>
</html>